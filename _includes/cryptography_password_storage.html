<h2>Password Storage</h2>
<p>If we are using passwords to authenticate users, then we need to remember the password for each user so that we can verify it each time a user logs in. This means that each password must be stored somewhere. If someone were to break into the system, they could potentially get all of our user passwords. What should we do?</p>
<p>We could encrypt our passwords with some secret key, and unencrypt them to compare to what a user types when logging in. But if someone has broken our system, they can probably get this private key as well, and we are back to all passwords being compromised. A better solution would be one in which the system never needs to have the password in cleartext.</p>
<p>Enter the one-way cryptographically-secure hash. If we store the hash of the user's password, then there is no (feasible) way to get the password from our system. When the user enters a password, we hash what they entered and compare this to the stored hash.</p>
<p>But wait! Users often choose common passwords. Looking at compromised password databases, <a target="_blank" href="https://www.cbsnews.com/news/these-were-the-25-worst-passwords-of-2015/">123456 or password have topped the list of most common passwords for years</a>. The same password means the same hash, which means that all someone needs to do is hash common passwords with common hashing algorithms and compare them to the stored hashes and they can figure out the passwords for a large number of the accounts. In fact, people have created lists of these hashes, called <strong>rainbow tables</strong> which contain the most common passwords hashed by popular hashing algorithms.</p>
<p>To help solve the rainbow table problem, we can use salts. A salt is some data, different for each user, that is added to their password before hashing. Typically salts are long random strings -- long just to make sure it really is unique to that user. The salt is not secret, unlike the password, and can be stored in plaintext. It is just meant to make sure every user has a unique hash even if they have used the same password. Someone could still find an individual user's password by trying the hash of a bunch of common passwords with the salt to see if they match, but this doesn't help them with any other users. They have to go through the full process with each one, and thus it takes them a lot longer.</p>
<p>Another thing that helps with security is to use a slower hash, like <a target="_blank" href="https://en.wikipedia.org/wiki/Bcrypt">bcrypt</a>, or one that requires a great deal of memory, like <a target="_blank" href="http://www.tarsnap.com/scrypt.html">scrypt</a>, or one that requires a lot of computation, uses a lot of memory, and requires a certain number of threads, like <a target="_blank" href="https://password-hashing.net/">Argon2</a>. Since legitimate users only need to run the hash once (or as many times as they mis-type their password) when they log in, the slowdown will likely not matter to them. Attackers, on the other hand, will be very inconvenienced because they are running a huge number of hashes to try to find a match for each user.</p>
<p>In summary, for password storage:</p>
<ul>
<li>choose a long random salt that is different for each user</li>
<li>store the salt and the hash of the password+salt</li>
<li>do <em>not</em> store the password</li>
<li>use a hashing function that requires a lot of resources</li>
<li>don't allow users to choose short or common passwords</li>
</ul>
